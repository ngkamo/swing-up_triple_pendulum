function dy = three_dof_arm_cart_dyn_for_ODE(t,y,u,l1,l2,l3,m1,m2,m3,M,g)
    load('motion_equations.mat','fx');
	y1 = y(1);
	y2 = y(2);
	y3 = y(3);
	y4 = y(4);
	y5 = y(5);
	y6 = y(6);
	y7 = y(7);
	y8 = y(8);

	u1 = u(1);
	u2 = u(2);
	u3 = u(3);
	u4 = u(4);


	% These equations are derived from the file Symb_Development_3DOF
	dy1 = y2;
	dy2 = (240*m2^2*u1 + 144*m3^2*u1 - 144*m2^2*u1*cos(2*y3 - 2*y5) - 144*m3^2*u1*cos(2*y3 - 2*y5) + 128*m1*m2*u1 + 240*m1*m3*u1 + 600*m2*m3*u1 + 48*g*m2^3*sin(2*y3) - 360*m2*m3*u1*cos(2*y3 - 2*y5) + 72*m2*m3*u1*cos(2*y3 - 2*y7) - 144*m1*m3*u1*cos(2*y5 - 2*y7) - 216*m2*m3*u1*cos(2*y5 - 2*y7) + 120*g*m1*m2^2*sin(2*y3) + 48*g*m1^2*m2*sin(2*y3) + 72*g*m1*m3^2*sin(2*y3) + 90*g*m1^2*m3*sin(2*y3) - 24*g*m1*m2^2*sin(2*y5) + 48*g*m2*m3^2*sin(2*y3) + 150*g*m2^2*m3*sin(2*y3) - 24*g*m1*m3^2*sin(2*y5) - 27*g*m1^2*m3*sin(2*y3 - 2*y5 + 2*y7) - 27*g*m1^2*m3*sin(2*y3 + 2*y5 - 2*y7) - 27*g*m2^2*m3*sin(2*y3 - 2*y5 + 2*y7) - 27*g*m2^2*m3*sin(2*y3 + 2*y5 - 2*y7) + 96*l1*m2^3*y4^2*sin(y3) + 24*l2*m2^3*y6^2*sin(y5) + 24*l2*m2^3*y6^2*sin(2*y3 - y5) + 24*l1*m1*m2^2*y4^2*sin(y3 - 2*y5) + 24*l1*m1*m3^2*y4^2*sin(y3 - 2*y5) + 18*l2*m2^2*m3*y6^2*sin(y5 - 2*y7) + 300*g*m1*m2*m3*sin(2*y3) - 60*g*m1*m2*m3*sin(2*y5) + 12*g*m1*m2*m3*sin(2*y7) + 48*l2*m1*m2^2*y6^2*sin(2*y3 - y5) + 72*l2*m1*m3^2*y6^2*sin(2*y3 - y5) + 48*l2*m2*m3^2*y6^2*sin(2*y3 - y5) + 90*l2*m2^2*m3*y6^2*sin(2*y3 - y5) + 18*l3*m1*m3^2*y8^2*sin(2*y3 - y7) + 6*l3*m2*m3^2*y8^2*sin(2*y3 - y7) - 12*l3*m2^2*m3*y8^2*sin(2*y3 - y7) + 6*l3*m1*m3^2*y8^2*sin(2*y5 - y7) + 18*l3*m2*m3^2*y8^2*sin(2*y5 - y7) + 36*l3*m2^2*m3*y8^2*sin(2*y5 - y7) - 54*g*m1*m2*m3*sin(2*y3 - 2*y5 + 2*y7) - 54*g*m1*m2*m3*sin(2*y3 + 2*y5 - 2*y7) + 200*l1*m1*m2^2*y4^2*sin(y3) + 64*l1*m1^2*m2*y4^2*sin(y3) + 120*l1*m1*m3^2*y4^2*sin(y3) + 120*l1*m1^2*m3*y4^2*sin(y3) + 96*l1*m2*m3^2*y4^2*sin(y3) + 300*l1*m2^2*m3*y4^2*sin(y3) + 16*l2*m1*m2^2*y6^2*sin(y5) + 24*l2*m1*m3^2*y6^2*sin(y5) + 48*l2*m2*m3^2*y6^2*sin(y5) + 90*l2*m2^2*m3*y6^2*sin(y5) + 6*l3*m1*m3^2*y8^2*sin(y7) + 6*l3*m2*m3^2*y8^2*sin(y7) - 12*l3*m2^2*m3*y8^2*sin(y7) - 36*l1*m1^2*m3*y4^2*sin(y3 - 2*y5 + 2*y7) - 36*l1*m1^2*m3*y4^2*sin(y3 + 2*y5 - 2*y7) - 54*l1*m2^2*m3*y4^2*sin(y3 - 2*y5 + 2*y7) - 54*l1*m2^2*m3*y4^2*sin(y3 + 2*y5 - 2*y7) - 18*l2*m2^2*m3*y6^2*sin(2*y3 + y5 - 2*y7) + 18*l3*m1*m3^2*y8^2*sin(2*y3 - 2*y5 + y7) + 18*l3*m2*m3^2*y8^2*sin(2*y3 - 2*y5 + y7) + 36*l3*m2^2*m3*y8^2*sin(2*y3 - 2*y5 + y7) + 60*l1*m1*m2*m3*y4^2*sin(y3 - 2*y5) - 12*l1*m1*m2*m3*y4^2*sin(y3 - 2*y7) + 6*l2*m1*m2*m3*y6^2*sin(y5 - 2*y7) + 150*l2*m1*m2*m3*y6^2*sin(2*y3 - y5) + 12*l3*m1*m2*m3*y8^2*sin(2*y3 - y7) + 12*l3*m1*m2*m3*y8^2*sin(2*y5 - y7) + 500*l1*m1*m2*m3*y4^2*sin(y3) + 50*l2*m1*m2*m3*y6^2*sin(y5) + 4*l3*m1*m2*m3*y8^2*sin(y7) - 90*l1*m1*m2*m3*y4^2*sin(y3 - 2*y5 + 2*y7) - 90*l1*m1*m2*m3*y4^2*sin(y3 + 2*y5 - 2*y7) - 18*l2*m1*m2*m3*y6^2*sin(2*y3 + y5 - 2*y7) + 36*l3*m1*m2*m3*y8^2*sin(2*y3 - 2*y5 + y7))/(240*M*m2^2 - 48*m2^3*cos(2*y3) + 144*M*m3^2 + 200*m1*m2^2 + 80*m1^2*m2 + 120*m1*m3^2 + 150*m1^2*m3 + 48*m2*m3^2 + 150*m2^2*m3 + 48*m2^3 - 72*m1*m2^2*cos(2*y3 - 2*y5) - 72*m1*m3^2*cos(2*y3 - 2*y5) - 90*m1^2*m3*cos(2*y5 - 2*y7) - 54*m2^2*m3*cos(2*y5 - 2*y7) + 128*M*m1*m2 + 240*M*m1*m3 + 600*M*m2*m3 + 500*m1*m2*m3 - 120*m1*m2^2*cos(2*y3) - 48*m1^2*m2*cos(2*y3) - 72*m1*m3^2*cos(2*y3) - 90*m1^2*m3*cos(2*y3) + 24*m1*m2^2*cos(2*y5) - 48*m2*m3^2*cos(2*y3) - 150*m2^2*m3*cos(2*y3) + 24*m1*m3^2*cos(2*y5) + 27*m1^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m1^2*m3*cos(2*y3 + 2*y5 - 2*y7) + 27*m2^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m2^2*m3*cos(2*y3 + 2*y5 - 2*y7) - 144*M*m2^2*cos(2*y3 - 2*y5) - 144*M*m3^2*cos(2*y3 - 2*y5) - 180*m1*m2*m3*cos(2*y3 - 2*y5) + 36*m1*m2*m3*cos(2*y3 - 2*y7) - 180*m1*m2*m3*cos(2*y5 - 2*y7) - 300*m1*m2*m3*cos(2*y3) + 60*m1*m2*m3*cos(2*y5) - 12*m1*m2*m3*cos(2*y7) + 54*m1*m2*m3*cos(2*y3 - 2*y5 + 2*y7) + 54*m1*m2*m3*cos(2*y3 + 2*y5 - 2*y7) - 360*M*m2*m3*cos(2*y3 - 2*y5) + 72*M*m2*m3*cos(2*y3 - 2*y7) - 144*M*m1*m3*cos(2*y5 - 2*y7) - 216*M*m2*m3*cos(2*y5 - 2*y7));
	dy3 = y4;
	dy4 = -(24*(10*m2^2*u1*cos(y3) + 6*m3^2*u1*cos(y3) + 4*g*m2^3*sin(y3) - 6*m2^2*u1*cos(y3 - 2*y5) - 6*m3^2*u1*cos(y3 - 2*y5) + 6*M*g*m2^2*sin(y3 - 2*y5) + 6*M*g*m3^2*sin(y3 - 2*y5) + 3*g*m1*m2^2*sin(y3 - 2*y5) + 3*g*m1*m3^2*sin(y3 - 2*y5) + l2*m2^3*y6^2*sin(y3 + y5) + 8*m1*m2*u1*cos(y3) + 15*m1*m3*u1*cos(y3) + 25*m2*m3*u1*cos(y3) + l2*m2^3*y6^2*sin(y3 - y5) - (9*m1*m3*u1*cos(y3 - 2*y5 + 2*y7))/2 - (9*m1*m3*u1*cos(y3 + 2*y5 - 2*y7))/2 - (9*m2*m3*u1*cos(y3 - 2*y5 + 2*y7))/2 - (9*m2*m3*u1*cos(y3 + 2*y5 - 2*y7))/2 + 2*l1*m2^3*y4^2*sin(2*y3) - 15*m2*m3*u1*cos(y3 - 2*y5) + 3*m2*m3*u1*cos(y3 - 2*y7) + 10*M*g*m2^2*sin(y3) + 6*M*g*m3^2*sin(y3) + 15*g*m1*m2^2*sin(y3) + 8*g*m1^2*m2*sin(y3) + 9*g*m1*m3^2*sin(y3) + 15*g*m1^2*m3*sin(y3) + 4*g*m2*m3^2*sin(y3) + (25*g*m2^2*m3*sin(y3))/2 - (9*g*m1^2*m3*sin(y3 - 2*y5 + 2*y7))/2 - (9*g*m1^2*m3*sin(y3 + 2*y5 - 2*y7))/2 - (9*g*m2^2*m3*sin(y3 - 2*y5 + 2*y7))/4 - (9*g*m2^2*m3*sin(y3 + 2*y5 - 2*y7))/4 + 6*l2*m1*m2^2*y6^2*sin(y3 - y5) + 9*l2*m1*m3^2*y6^2*sin(y3 - y5) + 2*l2*m2*m3^2*y6^2*sin(y3 - y5) + (15*l2*m2^2*m3*y6^2*sin(y3 - y5))/4 + (9*l3*m1*m3^2*y8^2*sin(y3 - y7))/4 + (l3*m2*m3^2*y8^2*sin(y3 - y7))/4 - (l3*m2^2*m3*y8^2*sin(y3 - y7))/2 - (27*g*m1*m2*m3*sin(y3 - 2*y5 + 2*y7))/4 - (27*g*m1*m2*m3*sin(y3 + 2*y5 - 2*y7))/4 + 15*M*g*m2*m3*sin(y3 - 2*y5) - 3*M*g*m2*m3*sin(y3 - 2*y7) + 5*l1*m1*m2^2*y4^2*sin(2*y3) + 2*l1*m1^2*m2*y4^2*sin(2*y3) + 3*l1*m1*m3^2*y4^2*sin(2*y3) + (15*l1*m1^2*m3*y4^2*sin(2*y3))/4 + 2*l1*m2*m3^2*y4^2*sin(2*y3) + (25*l1*m2^2*m3*y4^2*sin(2*y3))/4 + (15*g*m1*m2*m3*sin(y3 - 2*y5))/2 - (3*g*m1*m2*m3*sin(y3 - 2*y7))/2 - (9*l1*m1^2*m3*y4^2*sin(2*y3 - 2*y5 + 2*y7))/8 - (9*l1*m1^2*m3*y4^2*sin(2*y3 + 2*y5 - 2*y7))/8 - (9*l1*m2^2*m3*y4^2*sin(2*y3 - 2*y5 + 2*y7))/8 - (9*l1*m2^2*m3*y4^2*sin(2*y3 + 2*y5 - 2*y7))/8 + 6*M*l1*m2^2*y4^2*sin(2*y3 - 2*y5) + 6*M*l1*m3^2*y4^2*sin(2*y3 - 2*y5) + 3*M*l3*m3^2*y8^2*sin(y3 - 2*y5 + y7) + 3*l1*m1*m2^2*y4^2*sin(2*y3 - 2*y5) + 3*l1*m1*m3^2*y4^2*sin(2*y3 - 2*y5) - (3*l2*m2^2*m3*y6^2*sin(y3 + y5 - 2*y7))/4 + (9*l3*m1*m3^2*y8^2*sin(y3 - 2*y5 + y7))/4 + (3*l3*m2*m3^2*y8^2*sin(y3 - 2*y5 + y7))/4 + (3*l3*m2^2*m3*y8^2*sin(y3 - 2*y5 + y7))/2 + 2*l2*m1*m2^2*y6^2*sin(y3 + y5) + 3*l2*m1*m3^2*y6^2*sin(y3 + y5) + 2*l2*m2*m3^2*y6^2*sin(y3 + y5) + (15*l2*m2^2*m3*y6^2*sin(y3 + y5))/4 + (3*l3*m1*m3^2*y8^2*sin(y3 + y7))/4 + (l3*m2*m3^2*y8^2*sin(y3 + y7))/4 - (l3*m2^2*m3*y8^2*sin(y3 + y7))/2 + 8*M*g*m1*m2*sin(y3) + 15*M*g*m1*m3*sin(y3) + 25*M*g*m2*m3*sin(y3) - (3*l2*m2^2*m3*y6^2*sin(y3 - y5 + 2*y7))/4 + (3*l3*m1*m3^2*y8^2*sin(y3 + 2*y5 - y7))/4 + (3*l3*m2*m3^2*y8^2*sin(y3 + 2*y5 - y7))/4 + (3*l3*m2^2*m3*y8^2*sin(y3 + 2*y5 - y7))/2 + 8*M*l2*m2^2*y6^2*sin(y3 - y5) + 12*M*l2*m3^2*y6^2*sin(y3 - y5) + 3*M*l3*m3^2*y8^2*sin(y3 - y7) - (9*M*g*m1*m3*sin(y3 - 2*y5 + 2*y7))/2 - (9*M*g*m1*m3*sin(y3 + 2*y5 - 2*y7))/2 - (9*M*g*m2*m3*sin(y3 - 2*y5 + 2*y7))/2 - (9*M*g*m2*m3*sin(y3 + 2*y5 - 2*y7))/2 + (75*g*m1*m2*m3*sin(y3))/2 + (75*l2*m1*m2*m3*y6^2*sin(y3 - y5))/4 + (3*l3*m1*m2*m3*y8^2*sin(y3 - y7))/2 + (25*l1*m1*m2*m3*y4^2*sin(2*y3))/2 - (9*l1*m1*m2*m3*y4^2*sin(2*y3 - 2*y5 + 2*y7))/4 - (9*l1*m1*m2*m3*y4^2*sin(2*y3 + 2*y5 - 2*y7))/4 + 15*M*l1*m2*m3*y4^2*sin(2*y3 - 2*y5) - 3*M*l1*m2*m3*y4^2*sin(2*y3 - 2*y7) - 3*M*l2*m2*m3*y6^2*sin(y3 + y5 - 2*y7) + 6*M*l3*m2*m3*y8^2*sin(y3 - 2*y5 + y7) + (15*l1*m1*m2*m3*y4^2*sin(2*y3 - 2*y5))/2 - (3*l1*m1*m2*m3*y4^2*sin(2*y3 - 2*y7))/2 - (9*l2*m1*m2*m3*y6^2*sin(y3 + y5 - 2*y7))/4 + (9*l3*m1*m2*m3*y8^2*sin(y3 - 2*y5 + y7))/2 + (25*l2*m1*m2*m3*y6^2*sin(y3 + y5))/4 + (l3*m1*m2*m3*y8^2*sin(y3 + y7))/2 - (3*l2*m1*m2*m3*y6^2*sin(y3 - y5 + 2*y7))/4 + (3*l3*m1*m2*m3*y8^2*sin(y3 + 2*y5 - y7))/2 + 25*M*l2*m2*m3*y6^2*sin(y3 - y5) + 2*M*l3*m2*m3*y8^2*sin(y3 - y7)))/(l1*(240*M*m2^2 - 48*m2^3*cos(2*y3) + 144*M*m3^2 + 200*m1*m2^2 + 80*m1^2*m2 + 120*m1*m3^2 + 150*m1^2*m3 + 48*m2*m3^2 + 150*m2^2*m3 + 48*m2^3 - 72*m1*m2^2*cos(2*y3 - 2*y5) - 72*m1*m3^2*cos(2*y3 - 2*y5) - 90*m1^2*m3*cos(2*y5 - 2*y7) - 54*m2^2*m3*cos(2*y5 - 2*y7) + 128*M*m1*m2 + 240*M*m1*m3 + 600*M*m2*m3 + 500*m1*m2*m3 - 120*m1*m2^2*cos(2*y3) - 48*m1^2*m2*cos(2*y3) - 72*m1*m3^2*cos(2*y3) - 90*m1^2*m3*cos(2*y3) + 24*m1*m2^2*cos(2*y5) - 48*m2*m3^2*cos(2*y3) - 150*m2^2*m3*cos(2*y3) + 24*m1*m3^2*cos(2*y5) + 27*m1^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m1^2*m3*cos(2*y3 + 2*y5 - 2*y7) + 27*m2^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m2^2*m3*cos(2*y3 + 2*y5 - 2*y7) - 144*M*m2^2*cos(2*y3 - 2*y5) - 144*M*m3^2*cos(2*y3 - 2*y5) - 180*m1*m2*m3*cos(2*y3 - 2*y5) + 36*m1*m2*m3*cos(2*y3 - 2*y7) - 180*m1*m2*m3*cos(2*y5 - 2*y7) - 300*m1*m2*m3*cos(2*y3) + 60*m1*m2*m3*cos(2*y5) - 12*m1*m2*m3*cos(2*y7) + 54*m1*m2*m3*cos(2*y3 - 2*y5 + 2*y7) + 54*m1*m2*m3*cos(2*y3 + 2*y5 - 2*y7) - 360*M*m2*m3*cos(2*y3 - 2*y5) + 72*M*m2*m3*cos(2*y3 - 2*y7) - 144*M*m1*m3*cos(2*y5 - 2*y7) - 216*M*m2*m3*cos(2*y5 - 2*y7)));
 	dy5 = y6;
 	dy6 = (24*(12*m2^2*u1*cos(2*y3 - y5) + 6*m3^2*u1*cos(2*y3 - y5) - 12*m2^2*u1*cos(y5) - 6*m3^2*u1*cos(y5) + 6*m1*m2*u1*cos(2*y3 - y5) + (15*m1*m3*u1*cos(2*y3 - y5))/2 + (45*m2*m3*u1*cos(2*y3 - y5))/2 + (3*g*m1^2*m3*sin(y5 - 2*y7))/4 + 12*M*g*m2^2*sin(2*y3 - y5) + 6*M*g*m3^2*sin(2*y3 - y5) + 6*g*m1*m2^2*sin(2*y3 - y5) + 3*g*m1^2*m2*sin(2*y3 - y5) + 3*g*m1*m3^2*sin(2*y3 - y5) + (15*g*m1^2*m3*sin(2*y3 - y5))/4 - 2*m1*m2*u1*cos(y5) - (5*m1*m3*u1*cos(y5))/2 - (45*m2*m3*u1*cos(y5))/2 - (9*m1*m3*u1*cos(2*y3 + y5 - 2*y7))/2 - (9*m2*m3*u1*cos(2*y3 + y5 - 2*y7))/2 + (3*m1*m3*u1*cos(y5 - 2*y7))/2 + (9*m2*m3*u1*cos(y5 - 2*y7))/2 - 12*M*g*m2^2*sin(y5) - 6*M*g*m3^2*sin(y5) - 2*g*m1*m2^2*sin(y5) + g*m1^2*m2*sin(y5) - g*m1*m3^2*sin(y5) + (5*g*m1^2*m3*sin(y5))/4 - (9*g*m1^2*m3*sin(2*y3 + y5 - 2*y7))/4 + 10*l1*m1*m2^2*y4^2*sin(y3 - y5) + 3*l1*m1^2*m2*y4^2*sin(y3 - y5) + 5*l1*m1*m3^2*y4^2*sin(y3 - y5) + (15*l1*m1^2*m3*y4^2*sin(y3 - y5))/4 - (5*l3*m1*m3^2*y8^2*sin(y5 - y7))/2 - 5*l3*m1^2*m3*y8^2*sin(y5 - y7) - (3*l3*m2*m3^2*y8^2*sin(y5 - y7))/2 - 6*l3*m2^2*m3*y8^2*sin(y5 - y7) - (9*g*m1*m2*m3*sin(2*y3 + y5 - 2*y7))/4 - (3*M*g*m1*m3*sin(y5 - 2*y7))/2 - (9*M*g*m2*m3*sin(y5 - 2*y7))/2 + l2*m1*m2^2*y6^2*sin(2*y5) + l2*m1*m3^2*y6^2*sin(2*y5) - (3*g*m1*m2*m3*sin(y5 - 2*y7))/4 - (9*l2*m1^2*m3*y6^2*sin(2*y3 - 2*y5 + 2*y7))/8 + (9*l2*m1^2*m3*y6^2*sin(2*y3 + 2*y5 - 2*y7))/8 - (9*l2*m2^2*m3*y6^2*sin(2*y3 - 2*y5 + 2*y7))/8 + (9*l2*m2^2*m3*y6^2*sin(2*y3 + 2*y5 - 2*y7))/8 + 6*M*l2*m2^2*y6^2*sin(2*y3 - 2*y5) + 6*M*l2*m3^2*y6^2*sin(2*y3 - 2*y5) - 3*M*l3*m3^2*y8^2*sin(y5 - 2*y3 + y7) + 3*l2*m1*m2^2*y6^2*sin(2*y3 - 2*y5) + 3*l2*m1*m3^2*y6^2*sin(2*y3 - 2*y5) - (15*l2*m1^2*m3*y6^2*sin(2*y5 - 2*y7))/4 - (9*l2*m2^2*m3*y6^2*sin(2*y5 - 2*y7))/4 + 6*M*g*m1*m2*sin(2*y3 - y5) + (15*M*g*m1*m3*sin(2*y3 - y5))/2 + (45*M*g*m2*m3*sin(2*y3 - y5))/2 - (9*l1*m1^2*m3*y4^2*sin(y3 + y5 - 2*y7))/4 - (3*l3*m1*m3^2*y8^2*sin(y5 - 2*y3 + y7))/2 + (45*g*m1*m2*m3*sin(2*y3 - y5))/4 + 2*l1*m1*m2^2*y4^2*sin(y3 + y5) + l1*m1^2*m2*y4^2*sin(y3 + y5) + l1*m1*m3^2*y4^2*sin(y3 + y5) + (5*l1*m1^2*m3*y4^2*sin(y3 + y5))/4 + (l3*m1*m3^2*y8^2*sin(y5 + y7))/2 - 2*M*g*m1*m2*sin(y5) - (5*M*g*m1*m3*sin(y5))/2 - (45*M*g*m2*m3*sin(y5))/2 - (3*l1*m1^2*m3*y4^2*sin(y3 - y5 + 2*y7))/4 + (3*l3*m1*m3^2*y8^2*sin(2*y3 + y5 - y7))/4 - (3*l3*m1*m3^2*y8^2*sin(2*y3 - y5 + y7))/4 + (3*l3*m1^2*m3*y8^2*sin(2*y3 + y5 - y7))/2 - (3*l3*m1^2*m3*y8^2*sin(2*y3 - y5 + y7))/2 + (3*l3*m2*m3^2*y8^2*sin(2*y3 + y5 - y7))/4 - (3*l3*m2*m3^2*y8^2*sin(2*y3 - y5 + y7))/4 + 3*l3*m2^2*m3*y8^2*sin(2*y3 + y5 - y7) - 3*l3*m2^2*m3*y8^2*sin(2*y3 - y5 + y7) + 24*M*l1*m2^2*y4^2*sin(y3 - y5) + 12*M*l1*m3^2*y4^2*sin(y3 - y5) - 3*M*l3*m3^2*y8^2*sin(y5 - y7) - (9*M*g*m1*m3*sin(2*y3 + y5 - 2*y7))/2 - (9*M*g*m2*m3*sin(2*y3 + y5 - 2*y7))/2 - (15*g*m1*m2*m3*sin(y5))/4 + (75*l1*m1*m2*m3*y4^2*sin(y3 - y5))/4 - 15*l3*m1*m2*m3*y8^2*sin(y5 - y7) + (5*l2*m1*m2*m3*y6^2*sin(2*y5))/2 - (9*l2*m1*m2*m3*y6^2*sin(2*y3 - 2*y5 + 2*y7))/4 + (9*l2*m1*m2*m3*y6^2*sin(2*y3 + 2*y5 - 2*y7))/4 + 15*M*l2*m2*m3*y6^2*sin(2*y3 - 2*y5) - 6*M*l2*m1*m3*y6^2*sin(2*y5 - 2*y7) - 9*M*l2*m2*m3*y6^2*sin(2*y5 - 2*y7) - 6*M*l1*m1*m3*y4^2*sin(y3 + y5 - 2*y7) - 9*M*l1*m2*m3*y4^2*sin(y3 + y5 - 2*y7) - 6*M*l3*m2*m3*y8^2*sin(y5 - 2*y3 + y7) + (15*l2*m1*m2*m3*y6^2*sin(2*y3 - 2*y5))/2 - (15*l2*m1*m2*m3*y6^2*sin(2*y5 - 2*y7))/2 - (15*l1*m1*m2*m3*y4^2*sin(y3 + y5 - 2*y7))/4 - 3*l3*m1*m2*m3*y8^2*sin(y5 - 2*y3 + y7) + (15*l1*m1*m2*m3*y4^2*sin(y3 + y5))/4 + l3*m1*m2*m3*y8^2*sin(y5 + y7) - (3*l1*m1*m2*m3*y4^2*sin(y3 - y5 + 2*y7))/4 + (9*l3*m1*m2*m3*y8^2*sin(2*y3 + y5 - y7))/2 - (9*l3*m1*m2*m3*y8^2*sin(2*y3 - y5 + y7))/2 + 8*M*l1*m1*m2*y4^2*sin(y3 - y5) + 10*M*l1*m1*m3*y4^2*sin(y3 - y5) + 45*M*l1*m2*m3*y4^2*sin(y3 - y5) - 8*M*l3*m1*m3*y8^2*sin(y5 - y7) - 18*M*l3*m2*m3*y8^2*sin(y5 - y7)))/(l2*(240*M*m2^2 - 48*m2^3*cos(2*y3) + 144*M*m3^2 + 200*m1*m2^2 + 80*m1^2*m2 + 120*m1*m3^2 + 150*m1^2*m3 + 48*m2*m3^2 + 150*m2^2*m3 + 48*m2^3 - 72*m1*m2^2*cos(2*y3 - 2*y5) - 72*m1*m3^2*cos(2*y3 - 2*y5) - 90*m1^2*m3*cos(2*y5 - 2*y7) - 54*m2^2*m3*cos(2*y5 - 2*y7) + 128*M*m1*m2 + 240*M*m1*m3 + 600*M*m2*m3 + 500*m1*m2*m3 - 120*m1*m2^2*cos(2*y3) - 48*m1^2*m2*cos(2*y3) - 72*m1*m3^2*cos(2*y3) - 90*m1^2*m3*cos(2*y3) + 24*m1*m2^2*cos(2*y5) - 48*m2*m3^2*cos(2*y3) - 150*m2^2*m3*cos(2*y3) + 24*m1*m3^2*cos(2*y5) + 27*m1^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m1^2*m3*cos(2*y3 + 2*y5 - 2*y7) + 27*m2^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m2^2*m3*cos(2*y3 + 2*y5 - 2*y7) - 144*M*m2^2*cos(2*y3 - 2*y5) - 144*M*m3^2*cos(2*y3 - 2*y5) - 180*m1*m2*m3*cos(2*y3 - 2*y5) + 36*m1*m2*m3*cos(2*y3 - 2*y7) - 180*m1*m2*m3*cos(2*y5 - 2*y7) - 300*m1*m2*m3*cos(2*y3) + 60*m1*m2*m3*cos(2*y5) - 12*m1*m2*m3*cos(2*y7) + 54*m1*m2*m3*cos(2*y3 - 2*y5 + 2*y7) + 54*m1*m2*m3*cos(2*y3 + 2*y5 - 2*y7) - 360*M*m2*m3*cos(2*y3 - 2*y5) + 72*M*m2*m3*cos(2*y3 - 2*y7) - 144*M*m1*m3*cos(2*y5 - 2*y7) - 216*M*m2*m3*cos(2*y5 - 2*y7)));
 	dy7 = y8;
 	dy8 = (108*m2^2*u1*cos(2*y5 - y7) - 36*m2^2*u1*cos(2*y3 - y7) + 36*m2^2*u1*cos(y7) - 108*m2^2*u1*cos(2*y3 - 2*y5 + y7) + 36*m1*m2*u1*cos(2*y3 - y7) + 216*m1*m3*u1*cos(2*y3 - y7) + 36*m1*m2*u1*cos(2*y5 - y7) + 72*m2*m3*u1*cos(2*y3 - y7) + 72*m1*m3*u1*cos(2*y5 - y7) + 216*m2*m3*u1*cos(2*y5 - y7) - 36*M*g*m2^2*sin(2*y3 - y7) + 108*M*g*m2^2*sin(2*y5 - y7) - 18*l2*m2^3*y6^2*sin(2*y3 + y5 - y7) + 18*l2*m2^3*y6^2*sin(2*y3 - y5 + y7) - 18*g*m1*m2^2*sin(2*y3 - y7) + 18*g*m1^2*m2*sin(2*y3 - y7) + 108*g*m1^2*m3*sin(2*y3 - y7) + 18*g*m1*m2^2*sin(2*y5 - y7) - 18*g*m1^2*m2*sin(2*y5 - y7) - 36*g*m1^2*m3*sin(2*y5 - y7) - 12*m1*m2*u1*cos(y7) - 72*m1*m3*u1*cos(y7) - 72*m2*m3*u1*cos(y7) + 36*l2*m2^3*y6^2*sin(y5 - y7) - 108*m1*m2*u1*cos(2*y3 - 2*y5 + y7) - 216*m1*m3*u1*cos(2*y3 - 2*y5 + y7) - 216*m2*m3*u1*cos(2*y3 - 2*y5 + y7) + 36*M*g*m2^2*sin(y7) - 108*M*g*m2^2*sin(2*y3 - 2*y5 + y7) + 6*g*m1*m2^2*sin(y7) + 6*g*m1^2*m2*sin(y7) + 36*g*m1^2*m3*sin(y7) - 54*g*m1*m2^2*sin(2*y3 - 2*y5 + y7) - 54*g*m1^2*m2*sin(2*y3 - 2*y5 + y7) - 108*g*m1^2*m3*sin(2*y3 - 2*y5 + y7) - 30*l1*m1*m2^2*y4^2*sin(y3 - y7) + 18*l1*m1^2*m2*y4^2*sin(y3 - y7) + 108*l1*m1^2*m3*y4^2*sin(y3 - y7) + 180*l2*m1*m2^2*y6^2*sin(y5 - y7) + 120*l2*m1^2*m2*y6^2*sin(y5 - y7) + 360*l2*m1^2*m3*y6^2*sin(y5 - y7) + 144*l2*m2^2*m3*y6^2*sin(y5 - y7) - 108*g*m1*m2*m3*sin(2*y3 - 2*y5 + y7) + 27*l3*m1^2*m3*y8^2*sin(2*y3 - 2*y5 + 2*y7) - 27*l3*m1^2*m3*y8^2*sin(2*y3 + 2*y5 - 2*y7) + 27*l3*m2^2*m3*y8^2*sin(2*y3 - 2*y5 + 2*y7) - 27*l3*m2^2*m3*y8^2*sin(2*y3 + 2*y5 - 2*y7) - 216*M*l1*m2^2*y4^2*sin(y3 - 2*y5 + y7) + 72*M*l2*m2^2*y6^2*sin(y5 - 2*y3 + y7) + 90*l3*m1^2*m3*y8^2*sin(2*y5 - 2*y7) + 54*l3*m2^2*m3*y8^2*sin(2*y5 - 2*y7) + 36*M*g*m1*m2*sin(2*y3 - y7) + 216*M*g*m1*m3*sin(2*y3 - y7) + 36*M*g*m1*m2*sin(2*y5 - y7) + 72*M*g*m2*m3*sin(2*y3 - y7) + 72*M*g*m1*m3*sin(2*y5 - y7) + 216*M*g*m2*m3*sin(2*y5 - y7) - 90*l1*m1*m2^2*y4^2*sin(y3 - 2*y5 + y7) - 54*l1*m1^2*m2*y4^2*sin(y3 - 2*y5 + y7) - 108*l1*m1^2*m3*y4^2*sin(y3 - 2*y5 + y7) + 36*l2*m1*m2^2*y6^2*sin(y5 - 2*y3 + y7) + 36*g*m1*m2*m3*sin(2*y3 - y7) + 36*g*m1*m2*m3*sin(2*y5 - y7) - 6*l1*m1*m2^2*y4^2*sin(y3 + y7) + 6*l1*m1^2*m2*y4^2*sin(y3 + y7) + 36*l1*m1^2*m3*y4^2*sin(y3 + y7) - 12*l2*m1*m2^2*y6^2*sin(y5 + y7) - 12*M*g*m1*m2*sin(y7) - 72*M*g*m1*m3*sin(y7) - 72*M*g*m2*m3*sin(y7) - 18*l1*m1*m2^2*y4^2*sin(y3 + 2*y5 - y7) - 18*l1*m1^2*m2*y4^2*sin(y3 + 2*y5 - y7) - 36*l1*m1^2*m3*y4^2*sin(y3 + 2*y5 - y7) - 54*l2*m1*m2^2*y6^2*sin(2*y3 + y5 - y7) + 54*l2*m1*m2^2*y6^2*sin(2*y3 - y5 + y7) - 36*l2*m1^2*m2*y6^2*sin(2*y3 + y5 - y7) + 36*l2*m1^2*m2*y6^2*sin(2*y3 - y5 + y7) - 108*l2*m1^2*m3*y6^2*sin(2*y3 + y5 - y7) + 108*l2*m1^2*m3*y6^2*sin(2*y3 - y5 + y7) - 72*l2*m2^2*m3*y6^2*sin(2*y3 + y5 - y7) + 72*l2*m2^2*m3*y6^2*sin(2*y3 - y5 + y7) - 72*M*l1*m2^2*y4^2*sin(y3 - y7) + 216*M*l2*m2^2*y6^2*sin(y5 - y7) - 108*M*g*m1*m2*sin(2*y3 - 2*y5 + y7) - 216*M*g*m1*m3*sin(2*y3 - 2*y5 + y7) - 216*M*g*m2*m3*sin(2*y3 - 2*y5 + y7) - 12*g*m1*m2*m3*sin(y7) + 60*l1*m1*m2*m3*y4^2*sin(y3 - y7) + 600*l2*m1*m2*m3*y6^2*sin(y5 - y7) - 12*l3*m1*m2*m3*y8^2*sin(2*y7) + 54*l3*m1*m2*m3*y8^2*sin(2*y3 - 2*y5 + 2*y7) - 54*l3*m1*m2*m3*y8^2*sin(2*y3 + 2*y5 - 2*y7) - 72*M*l3*m2*m3*y8^2*sin(2*y3 - 2*y7) + 144*M*l3*m1*m3*y8^2*sin(2*y5 - 2*y7) + 216*M*l3*m2*m3*y8^2*sin(2*y5 - 2*y7) - 144*M*l1*m1*m2*y4^2*sin(y3 - 2*y5 + y7) - 288*M*l1*m1*m3*y4^2*sin(y3 - 2*y5 + y7) - 432*M*l1*m2*m3*y4^2*sin(y3 - 2*y5 + y7) + 144*M*l2*m2*m3*y6^2*sin(y5 - 2*y3 + y7) - 36*l3*m1*m2*m3*y8^2*sin(2*y3 - 2*y7) + 180*l3*m1*m2*m3*y8^2*sin(2*y5 - 2*y7) - 180*l1*m1*m2*m3*y4^2*sin(y3 - 2*y5 + y7) + 72*l2*m1*m2*m3*y6^2*sin(y5 - 2*y3 + y7) + 12*l1*m1*m2*m3*y4^2*sin(y3 + y7) - 24*l2*m1*m2*m3*y6^2*sin(y5 + y7) - 36*l1*m1*m2*m3*y4^2*sin(y3 + 2*y5 - y7) - 180*l2*m1*m2*m3*y6^2*sin(2*y3 + y5 - y7) + 180*l2*m1*m2*m3*y6^2*sin(2*y3 - y5 + y7) + 48*M*l1*m1*m2*y4^2*sin(y3 - y7) + 288*M*l1*m1*m3*y4^2*sin(y3 - y7) + 144*M*l1*m2*m3*y4^2*sin(y3 - y7) + 192*M*l2*m1*m2*y6^2*sin(y5 - y7) + 576*M*l2*m1*m3*y6^2*sin(y5 - y7) + 720*M*l2*m2*m3*y6^2*sin(y5 - y7))/(l3*(240*M*m2^2 - 48*m2^3*cos(2*y3) + 144*M*m3^2 + 200*m1*m2^2 + 80*m1^2*m2 + 120*m1*m3^2 + 150*m1^2*m3 + 48*m2*m3^2 + 150*m2^2*m3 + 48*m2^3 - 72*m1*m2^2*cos(2*y3 - 2*y5) - 72*m1*m3^2*cos(2*y3 - 2*y5) - 90*m1^2*m3*cos(2*y5 - 2*y7) - 54*m2^2*m3*cos(2*y5 - 2*y7) + 128*M*m1*m2 + 240*M*m1*m3 + 600*M*m2*m3 + 500*m1*m2*m3 - 120*m1*m2^2*cos(2*y3) - 48*m1^2*m2*cos(2*y3) - 72*m1*m3^2*cos(2*y3) - 90*m1^2*m3*cos(2*y3) + 24*m1*m2^2*cos(2*y5) - 48*m2*m3^2*cos(2*y3) - 150*m2^2*m3*cos(2*y3) + 24*m1*m3^2*cos(2*y5) + 27*m1^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m1^2*m3*cos(2*y3 + 2*y5 - 2*y7) + 27*m2^2*m3*cos(2*y3 - 2*y5 + 2*y7) + 27*m2^2*m3*cos(2*y3 + 2*y5 - 2*y7) - 144*M*m2^2*cos(2*y3 - 2*y5) - 144*M*m3^2*cos(2*y3 - 2*y5) - 180*m1*m2*m3*cos(2*y3 - 2*y5) + 36*m1*m2*m3*cos(2*y3 - 2*y7) - 180*m1*m2*m3*cos(2*y5 - 2*y7) - 300*m1*m2*m3*cos(2*y3) + 60*m1*m2*m3*cos(2*y5) - 12*m1*m2*m3*cos(2*y7) + 54*m1*m2*m3*cos(2*y3 - 2*y5 + 2*y7) + 54*m1*m2*m3*cos(2*y3 + 2*y5 - 2*y7) - 360*M*m2*m3*cos(2*y3 - 2*y5) + 72*M*m2*m3*cos(2*y3 - 2*y7) - 144*M*m1*m3*cos(2*y5 - 2*y7) - 216*M*m2*m3*cos(2*y5 - 2*y7)));

 	dy = [dy1 dy2 dy3 dy4 dy5 dy6 dy7 dy8]';